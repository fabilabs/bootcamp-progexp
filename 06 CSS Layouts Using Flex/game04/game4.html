<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Flexbox Challenge Pro</title>
<style>
  body { font-family: sans-serif; text-align: center; margin: 20px; background: #f0f0f0; }
  h1 { margin-bottom: 10px; }
  #contenedor {
    display: flex;
    border: 3px dashed #333;
    height: 200px;
    margin: 20px auto;
    width: 80%;
    transition: all 0.5s;
    background: white;
  }
  .caja {
    width: 50px; height: 50px;
    margin: 5px;
    display: flex;
    justify-content: center;
    align-items: center;
    font-weight: bold;
    border-radius: 5px;
    color: white;
    transition: all 0.5s;
  }
  select, button { margin: 5px; padding: 5px 10px; font-size: 1em; }
  #resultado, #puntaje, #timer { font-weight: bold; margin-top: 10px; }
</style>
</head>
<body>

<h1>ðŸŽ® Flexbox Challenge Pro</h1>
<p id="instruccion">InstrucciÃ³n: </p>

<div id="contenedor"></div>

<div>
  <label>Justify Content:</label>
  <select id="justify">
    <option value="flex-start">flex-start</option>
    <option value="center">center</option>
    <option value="flex-end">flex-end</option>
    <option value="space-between">space-between</option>
    <option value="space-around">space-around</option>
  </select>

  <label>Align Items:</label>
  <select id="align">
    <option value="flex-start">flex-start</option>
    <option value="center">center</option>
    <option value="flex-end">flex-end</option>
    <option value="stretch">stretch</option>
  </select>

  <label>Flex Direction:</label>
  <select id="direction">
    <option value="row">row</option>
    <option value="column">column</option>
  </select>

  <button onclick="aplicar()">Aplicar</button>
</div>

<p id="resultado"></p>
<p id="puntaje">Puntaje: 0 | Intentos: 0</p>
<p id="timer">Tiempo restante: 30s</p>

<script>
const contenedor = document.getElementById('contenedor');
const resultado = document.getElementById('resultado');
const instruccion = document.getElementById('instruccion');
const puntajeTxt = document.getElementById('puntaje');
const timerTxt = document.getElementById('timer');

const colores = ["crimson", "seagreen", "steelblue", "orange", "purple", "teal"];
const justifies = ["flex-start", "center", "flex-end", "space-between", "space-around"];
const aligns = ["flex-start", "center", "flex-end", "stretch"];
const directions = ["row", "column"];

let puntaje = 0;
let intentos = 0;
let tiempo = 30;
let timerInterval = null;

function generarNivel() {
  const numCajas = Math.floor(Math.random() * 3) + 4; // 4 a 6 cajas
  contenedor.innerHTML = "";
  for(let i=0; i<numCajas; i++) {
    const div = document.createElement('div');
    div.className = "caja";
    div.textContent = i+1;
    div.style.background = colores[i % colores.length];
    contenedor.appendChild(div);
  }

  const nivel = {
    justify: justifies[Math.floor(Math.random()*justifies.length)],
    align: aligns[Math.floor(Math.random()*aligns.length)],
    direction: directions[Math.floor(Math.random()*directions.length)]
  };

  instruccion.textContent = `InstrucciÃ³n: Justify=${nivel.justify}, Align=${nivel.align}, Direction=${nivel.direction}`;
  contenedor.dataset.justify = nivel.justify;
  contenedor.dataset.align = nivel.align;
  contenedor.dataset.direction = nivel.direction;

  // Reset selects y contenedor visual
  document.getElementById('justify').value = 'flex-start';
  document.getElementById('align').value = 'flex-start';
  document.getElementById('direction').value = 'row';
  contenedor.style.justifyContent = 'flex-start';
  contenedor.style.alignItems = 'flex-start';
  contenedor.style.flexDirection = 'row';
  resultado.textContent = '';

  // Reiniciar timer
  tiempo = 30;
  timerTxt.textContent = `Tiempo restante: ${tiempo}s`;
  if(timerInterval) clearInterval(timerInterval);
  timerInterval = setInterval(() => {
    tiempo--;
    timerTxt.textContent = `Tiempo restante: ${tiempo}s`;
    if(tiempo <= 0) {
      clearInterval(timerInterval);
      resultado.textContent = "Â¡Se acabÃ³ el tiempo! Generando nuevo nivel...";
      setTimeout(generarNivel, 1500);
    }
  }, 1000);
}

function aplicar() {
  const justify = document.getElementById('justify').value;
  const align = document.getElementById('align').value;
  const direction = document.getElementById('direction').value;

  contenedor.style.justifyContent = justify;
  contenedor.style.alignItems = align;
  contenedor.style.flexDirection = direction;

  intentos++;
  if(justify === contenedor.dataset.justify && align === contenedor.dataset.align && direction === contenedor.dataset.direction) {
    puntaje += 10;
    resultado.textContent = 'Â¡Correcto! ðŸŽ‰ Generando nuevo nivel...';
    clearInterval(timerInterval);
    setTimeout(generarNivel, 1500);
  } else {
    puntaje = Math.max(0, puntaje - 1);
    resultado.textContent = 'Intenta de nuevo ðŸ˜…';
  }
  puntajeTxt.textContent = `Puntaje: ${puntaje} | Intentos: ${intentos}`;
}

// Inicializar primer nivel
generarNivel();
</script>

</body>
</html>
